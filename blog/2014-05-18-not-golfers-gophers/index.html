<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.78 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:300;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;color:inherit;font-family:'Open Sans',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:2.2974rem;line-height:2.67rem;letter-spacing:-2px;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;color:inherit;font-family:'Open Sans',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;color:inherit;font-family:'Open Sans',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;color:inherit;font-family:'Open Sans',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;color:inherit;font-family:'Open Sans',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;color:inherit;font-family:'Open Sans',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;}ul{margin-left:1.78rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.78rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;font-size:0.85rem;line-height:1.78rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;font-size:1rem;line-height:1.78rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;}blockquote{margin-left:0;margin-right:1.78rem;margin-top:0;padding-bottom:0;padding-left:1.44625rem;padding-right:0;padding-top:0;margin-bottom:1.78rem;font-size:1.1487rem;line-height:1.78rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.33375rem solid hsla(0,0%,0%,0.2);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.78rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.78rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.78rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.78rem;margin-bottom:calc(1.78rem / 2);margin-top:calc(1.78rem / 2);}li > ul{margin-left:1.78rem;margin-bottom:calc(1.78rem / 2);margin-top:calc(1.78rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.78rem / 2);}code{font-size:0.85rem;line-height:1.78rem;}kbd{font-size:0.85rem;line-height:1.78rem;}samp{font-size:0.85rem;line-height:1.78rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.18667rem;padding-right:1.18667rem;padding-top:0.89rem;padding-bottom:calc(0.89rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}a{color:#4b0082;text-decoration:none;}a:hover,a:active{text-decoration:underline;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.78rem;color:hsla(0,0%,0%,0.9);font-weight:300;}blockquote cite:before{content:"â€” ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.78rem;}blockquote{margin-left:-1.335rem;margin-right:0;padding-left:1.00125rem;}}@media only screen and (max-width:768px){h1{font-size:2rem;line-height:2.67rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.56rem;}</style><meta name="generator" content="Gatsby 5.14.1"/><meta name="description" content="Personal site of Andy Weiss" data-gatsby-head="true"/><meta name="image" content="https://rokob.github.io/favicon-32x32.png" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta name="twitter:title" content="rokob :: Not Golfers, Gophers" data-gatsby-head="true"/><meta name="twitter:url" content="https://rokob.github.io/blog/2014-05-18-not-golfers-gophers/" data-gatsby-head="true"/><meta name="twitter:description" content="Personal site of Andy Weiss" data-gatsby-head="true"/><meta name="twitter:image" content="https://rokob.github.io/favicon-32x32.png" data-gatsby-head="true"/><meta name="twitter:creator" content="@dragonb3ar" data-gatsby-head="true"/><style data-href="/styles.f21535414e15f8faeffd.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#f8f8f2;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;text-shadow:0 1px rgba(0,0,0,.3);white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}pre[class*=language-].line-numbers{counter-reset:linenumber;padding-left:3.8em;position:relative}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{border-right:1px solid #999;font-size:100%;left:-3.8em;letter-spacing:-1px;pointer-events:none;position:absolute;top:0;-webkit-user-select:none;user-select:none;width:3em}.line-numbers-rows>span{counter-increment:linenumber;display:block}.line-numbers-rows>span:before{color:#999;content:counter(linenumber);display:block;padding-right:.8em;text-align:right}.gatsby-highlight-code-line{background-color:#feb;border-left:.25em solid #f99;display:block;margin-left:-1em;margin-right:-1em;padding-left:.75em;padding-right:1em}.gatsby-highlight{background-color:#272822;border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}.gatsby-highlight pre[class*=language-]{background-color:transparent;float:left;margin:0;min-width:100%;overflow:initial;padding:0}.gatsby-highlight pre[class*=language-].line-numbers{padding-left:2.8em}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link href="//fonts.googleapis.com/css?family=Open+Sans:700|Merriweather:300,300i,700,700i" rel="stylesheet" type="text/css"/><title data-gatsby-head="true">rokob :: Not Golfers, Gophers</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css 1snke1a">.css-1snke1a{margin:0 auto;max-width:800px;padding-bottom:3.56rem;padding-top:2.67rem;}@media only screen and (max-width: 801px){.css-1snke1a{width:93%;}}</style><div class="css-1snke1a erleo414"><a href="/"><style data-emotion="css 1w8900m">.css-1w8900m{margin-top:0;margin-bottom:1.78rem;display:inline-block;font-style:normal;}</style><h3 class="css-1w8900m erleo412">rokob</h3></a><style data-emotion="css tjo4qw">.css-tjo4qw{float:right;}</style><div class="css-tjo4qw erleo411"><style data-emotion="css 13y4rum">.css-13y4rum{padding-left:0.89rem;}</style><a class="css-13y4rum erleo410" href="/reading/">Reading</a><a class="css-13y4rum erleo410" href="/about/">About</a></div><style data-emotion="css 198bgkg">.css-198bgkg{margin-top:3.56rem;}</style><div class="css-198bgkg erleo413"><style data-emotion="css dfkuil">.css-dfkuil{margin-bottom:0.89rem;}</style><h2 class="css-dfkuil e13a1ij53">Not Golfers, Gophers</h2><style data-emotion="css 1f6tha0">.css-1f6tha0{margin-top:0.89rem;margin-bottom:1.78rem;color:#bbb;}</style><h3 class="css-1f6tha0 e13a1ij52">18 May 2014</h3><style data-emotion="css k4kvhd">.css-k4kvhd{margin-top:3.56rem;margin-bottom:1.78rem;color:inherit;}</style><div class="css-k4kvhd e13a1ij51"><style data-emotion="css k8h3ik">.css-k8h3ik{margin-top:0.89rem;margin-bottom:0.445rem;}</style><h4 class="css-k8h3ik e13a1ij50">Category: <!-- -->code</h4><h4 class="css-k8h3ik e13a1ij50"><a href="/tags/">Tags:</a> <a href="/tags/go/">go</a>, <a href="/tags/code/">code</a>, <a href="/tags/erlang/">erlang</a></h4></div><style data-emotion="css 1aujq9w">.css-1aujq9w{text-align:justify;}</style><div class="css-1aujq9w e13a1ij54"><p>I was doing some language exploration as I am toying with the idea of getting some backend
services up and running, and I have some constraints that Ruby does not meet. I kept hearing
people mention Go, and my only vague notion about it was that it was like Erlang but not
as mature, so I have been putting off really looking into it. Well that changed, I went through
the Go tour and have been playing around with it a bit, and I have to say I am really impressed.</p>
<h2>Channels vs Actors</h2>
<p>The actor model in Erlang encourages you to code in a certain style. Basically, you write
single purpose entities with a minimal amount of state, that operate using mostly pure functions.
The only interactions with the world outside of an actor are through message passing, and those
messages are typically tagged tuples. Each actor has a mailbox for getting messages which it typically
processes in a FIFO way, but you can also do selective receives by pattern matching on the messages
in your inbox. In this way, when you want to communicate to another actor, you need a reference
to their process identifier (PID), that you can use to send messages to. You usually get this
reference passed to you in a message. For instance, here is a raw version of a common pattern in
non-OTP code for the main loop of an Erlang actor:</p>
<div class="gatsby-highlight" data-language="erlang"><pre class="language-erlang"><code class="language-erlang"><span class="token comment">% some_guy.erl</span>
<span class="token function">live</span><span class="token punctuation">(</span><span class="token variable">State</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span>
  <span class="token keyword">receive</span>
    <span class="token punctuation">{</span><span class="token variable">From</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token atom">handshake</span><span class="token punctuation">,</span> <span class="token variable">Person</span><span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">-</span><span class="token operator">></span>
      <span class="token variable">NewState</span> <span class="token operator">=</span> <span class="token function">shake_hands</span><span class="token punctuation">(</span><span class="token variable">State</span><span class="token punctuation">,</span> <span class="token variable">Person</span><span class="token punctuation">)</span>
      <span class="token variable">From</span> <span class="token operator">!</span> <span class="token punctuation">{</span><span class="token function">self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token atom">ok</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">live</span><span class="token punctuation">(</span><span class="token variable">NewState</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">{</span><span class="token variable">From</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token atom">punch</span><span class="token punctuation">,</span> <span class="token variable">Person</span><span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">-</span><span class="token operator">></span>
      <span class="token variable">NewState</span> <span class="token operator">=</span> <span class="token function">get_punched</span><span class="token punctuation">(</span><span class="token variable">State</span><span class="token punctuation">,</span> <span class="token variable">Person</span><span class="token punctuation">)</span>
      <span class="token variable">From</span> <span class="token operator">!</span> <span class="token punctuation">{</span><span class="token function">self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token atom">ok</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">live</span><span class="token punctuation">(</span><span class="token variable">NewState</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token atom">terminate</span> <span class="token operator">-</span><span class="token operator">></span>
      <span class="token atom">ok</span>
  <span class="token keyword">end</span><span class="token punctuation">.</span></code></pre></div>
<p>This guy's life is pretty boring, he knows how to shake hands, get punched, and die. Here, we do
a selective receive on the mailbox, and the loop will only pull messages out of the mailbox that
are of the form <code class="language-text">{SomePID, {Action, Varible}}</code> where <code class="language-text">Action</code> is in a small set of known atoms.
He also responds to <code class="language-text">terminate</code> which stops him looping. The way you would message this guy
from another actor would look like</p>
<div class="gatsby-highlight" data-language="erlang"><pre class="language-erlang"><code class="language-erlang"><span class="token variable">SomeGuyPid</span> <span class="token operator">=</span> <span class="token function">spawn</span><span class="token punctuation">(</span><span class="token atom">some_guy</span><span class="token punctuation">,</span> <span class="token atom">live</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token variable">SomeGuyPid</span> <span class="token operator">!</span> <span class="token punctuation">{</span><span class="token function">self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token atom">handshake</span><span class="token punctuation">,</span> <span class="token string">"Me"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">.</span></code></pre></div>
<p>In Erlang, <code class="language-text">self()</code> returns your own PID, this allows us to send messages to others and get
replies back without them actually knowing who we are. This allows actors to be highly
decoupled and it makes it really easy to keep them single purpose. There needs to be some actor
at the top who spawns some processes, and maybe has a lookup table from names to PIDs, but
most of the actors you write simply receive a message with enough context to know who to
respond to. In reality you use OTP to build trees of communicating processes, and wrap these
bare message sends in APIs, but the underlying idea is the same. Actors have a mailbox with
an address (PID), and you can stuff their mailbox by sending a message to that address. It is
then up to them to choose what and when to pull out of their mailbox.</p>
<p>Go does not present these same primatives. Instead, Go has a type known as a <code class="language-text">Channel</code>. A
channel can be send-only, receive-only, or bidirectional. Any number of processes can
write to or read from a channel as long as they have a reference to it. If we want to reimplement
the same boring guy as above in Go, it might look something like (pardon my ignorance, I wrote
hello world in Go yesterday):</p>
<div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token comment">// some_guy.go</span>
<span class="token keyword">type</span> InMessage <span class="token keyword">interface</span> <span class="token punctuation">{</span>
  <span class="token function">inMessageType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> OutMessage <span class="token keyword">interface</span> <span class="token punctuation">{</span>
  <span class="token function">outMessageType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Request <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  From <span class="token keyword">chan</span> OutMessage
  Action <span class="token builtin">string</span>
  Person <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Atom <span class="token builtin">string</span>
<span class="token keyword">type</span> Response <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  From <span class="token keyword">chan</span>
  Status Atom
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a <span class="token operator">*</span>Atom<span class="token punctuation">)</span> <span class="token function">outMessageType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>a <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">outMessageType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a <span class="token operator">*</span>Atom<span class="token punctuation">)</span> <span class="token function">inMessageType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>a <span class="token operator">*</span>Request<span class="token punctuation">)</span> <span class="token function">inMessageType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">Live</span><span class="token punctuation">(</span>state <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> ch <span class="token keyword">chan</span> InMessage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  raw_msg <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch
  <span class="token keyword">switch</span> msg <span class="token operator">:=</span> raw_msg<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> Request<span class="token punctuation">:</span>
    <span class="token keyword">switch</span> msg<span class="token punctuation">.</span>Action <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token char">'handshake'</span><span class="token punctuation">:</span>
      new_state <span class="token operator">=</span> <span class="token function">shake_hands</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> msg<span class="token punctuation">.</span>Person<span class="token punctuation">)</span>
      msg<span class="token punctuation">.</span>From <span class="token operator">&lt;-</span> <span class="token operator">&amp;</span><span class="token punctuation">{</span>ch<span class="token punctuation">,</span> <span class="token string">"ok"</span><span class="token punctuation">}</span>
      <span class="token function">Live</span><span class="token punctuation">(</span>new_state<span class="token punctuation">,</span> ch<span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token char">'punch'</span><span class="token punctuation">:</span>
      new_state <span class="token operator">=</span> <span class="token function">get_punched</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> msg<span class="token punctuation">.</span>Person<span class="token punctuation">)</span>
      msg<span class="token punctuation">.</span>From <span class="token operator">&lt;-</span> <span class="token operator">&amp;</span><span class="token punctuation">{</span>ch<span class="token punctuation">,</span> <span class="token string">"ok"</span><span class="token punctuation">}</span>
      <span class="token function">Live</span><span class="token punctuation">(</span>new_state<span class="token punctuation">,</span> ch<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token keyword">case</span> Atom<span class="token punctuation">:</span>
    <span class="token keyword">if</span> msg <span class="token operator">==</span> <span class="token string">"terminate"</span> <span class="token punctuation">{</span>
      <span class="token comment">// "ok"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Although some of the trickeration I had to go through there with something like an
algebraic data type (ADT) was primiarly because of the constraints imposed by directly
translating from Erlang. I have found that the type of structures you use as communcation
primatives in an untyped language are drastically different than what you would choose
to use in a typed language. For instance, it is common to use a heterogeneous array
in languages like Python to repreesnt multiple return values, and this makes sense
because that is how the language allows you to work. Clearly you wouldn't do this
in a language like Haskell which does not allow heterogeneous lists, instead you
would typically use an ADT. In Erlang, you often use tuples, usually with type tags,
as the communication protocol, because of the nice pattern matching facilities, the
low overhead of these objects, and the complete lack of static types. In Go, we have
types, but not ADTs (well not naturally anyway), but we do have interfaces. Typically
this communication would be done over a more natural set of channels with a more
clearly defined interface for the objects being passed around.</p>
<p>I can imagine building channels in Erlang and Actors in Go using the set of primatives
that are offered, so I don't think they should really be seen as competing technologies
in that sense. However, Go encourages the use of typed channels for communication.
I think this is great. I think channels are more general and allow the type of flexibility
that you usually want. If you want a channel that only one goroutine uses then you can
do that really easily, you just only pass the reference to that function. But the ability
to build more complex communication networks out of channels is super interesting.
Also having some notion of static types on those channels is nice only because of the
flexibility of the type system in Go. Usually you have to jump through a lot of hoops
when you are dealing with making outside data type safe, but it seems like Go makes
an okay tradeoff here. My opinion on that is mostly grounded in my lack of experience
doing that everyday in a strong, statically typed language, it just feels like a ton
of extra work with real, but sometimes marginal benefits.</p>
<h2>Go oddities</h2>
<p>So I like the language of Go, but it has some goofy parts too. The one that bugs
me the most, is how it handles pointers, references, values, and interfaces. Okay,
that makes no sense I know, but here is the example (taken from part 55 of the Go tour):</p>
<div class="gatsby-highlight" data-language="go"><pre style="counter-reset: linenumber 0" class="language-go line-numbers"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"fmt"</span>
    <span class="token string">"math"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Abser <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">float64</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a Abser
    f <span class="token operator">:=</span> <span class="token function">MyFloat</span><span class="token punctuation">(</span><span class="token operator">-</span>math<span class="token punctuation">.</span>Sqrt2<span class="token punctuation">)</span>
    v <span class="token operator">:=</span> Vertex<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span>

    a <span class="token operator">=</span> f
    a <span class="token operator">=</span> <span class="token operator">&amp;</span>v

    <span class="token comment">// a = v</span>
    <span class="token comment">// uncomment the line above => no compile</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// this compiles just fine</span>

    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> MyFloat <span class="token builtin">float64</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>f MyFloat<span class="token punctuation">)</span> <span class="token function">Abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">float64</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> f <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">float64</span><span class="token punctuation">(</span><span class="token operator">-</span>f<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">float64</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Vertex <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    X<span class="token punctuation">,</span> Y <span class="token builtin">float64</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Vertex<span class="token punctuation">)</span> <span class="token function">Abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">float64</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> math<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>X<span class="token operator">*</span>v<span class="token punctuation">.</span>X <span class="token operator">+</span> v<span class="token punctuation">.</span>Y<span class="token operator">*</span>v<span class="token punctuation">.</span>Y<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>We are defining an interface called <code class="language-text">Abser</code> which has one functio <code class="language-text">Abs()</code> which returns a <code class="language-text">float64</code>.
At the bottom we define two types and implement the interface for them. However, for one, <code class="language-text">MyFloat</code>
we implement the interface with a value of the type, not a pointer. For the other, <code class="language-text">Vertex</code>, we
implement the interface only for a pointer to that type. Okay, now here is the weird part,
if you uncomment line 20, this will not compile. This is because you cannot assign a value of
type <code class="language-text">Vertex</code> to a variable of the interface type <code class="language-text">Abser</code> because there is no implementation for
<code class="language-text">Abs</code> on a value of type <code class="language-text">Vertex</code>. Now this is perfectly reasonable, it could be that the implementation
mutates the object and therefore only getting a copy via pass-by-value would not be the intended
behaviour. So Go makes the decision that because of that, there is no implementation for that type and
refuses to compile. However, the next line shows clearly that you can call <code class="language-text">Abs</code> on a <code class="language-text">Vertex</code> value.
This works just fine because the value is implicitly converted to a pointer. In many places, because
Go allows you to use the same syntax when working with a pointer, reference, and value, it can be
somewhat confusing to know which one you've got. Most of the time it doesn't really matter, but
the fact that it does enforce some constraints on this is a bit weird. Basically, just because you
see the following code:</p>
<div class="gatsby-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">type</span> X <span class="token keyword">interface</span> <span class="token punctuation">{</span>
  <span class="token function">someFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> v SomeType
  v<span class="token punctuation">.</span><span class="token function">someFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>It does not imply that <code class="language-text">v</code> actually implements the interface <code class="language-text">X</code> which entirely flies in the face
of duck typing intuition. It is only this edge case dealing with pointers and values that I know
of where you can make this happen, but still it is not desireable.</p>
<h2>Will I use it?</h2>
<p>I really like the strong standard library, the channel based concurrency primatives, and
the static typing. There is also a nice library called <a href="http://www.goworker.org/">goworker</a> which allows you
to use Go to write workers for jobs using <a href="https://github.com/resque/resque">Resque</a>. Basically, this means that in a Rails
app, you can push work onto a Redis queue, then have a Go process pull the work off that queue, and
do whatever it needs to do to process that job. Now clearly, you can pick any two languages and
any middle queueing system you want and make the same statement. However, the solid concurrency
primatives of Go, with a low memory footprint, combined with the fact that I am already preconstrained
to be working in a Rails environment, makes this set-up highly appealing. I am currently writing
background services in Ruby, which works and is a great language. But I think there are some services
where having high concurrency and high performance will be paramount and I want to have the ability
to handle those tasks sooner rather than later.</p></div><div><a href="https://github.com/rokob/rokob.github.com/commits/source/content/2014-05-18-not-golfers-gophers.md">History</a> -- <a href="https://github.com/rokob/rokob.github.com/commit/9a9b8cc9a846a5ab6c26cb187880f3092ad02345">9a9b8cc9</a></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/2014-05-18-not-golfers-gophers/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-74d18815dd077486fe4c.js\"],\"component---src-pages-about-js\":[\"/component---src-pages-about-js-12d390c00676b5f95045.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-71025402633be68d9d62.js\"],\"component---src-pages-reading-js\":[\"/component---src-pages-reading-js-cd120a53bb526792f88c.js\"],\"component---src-pages-tags-js\":[\"/component---src-pages-tags-js-551bcba74b82c97580b2.js\"],\"component---src-templates-blog-list-js\":[\"/component---src-templates-blog-list-js-4922d9da0b6024e3d157.js\"],\"component---src-templates-blog-post-js\":[\"/component---src-templates-blog-post-js-24e2de5845dfd5db0fc0.js\"],\"component---src-templates-tag-js\":[\"/component---src-templates-tag-js-195017f3819c4f1a843c.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="28e259d4c394b6f54b8e";</script><script src="/webpack-runtime-6f516ec0fd1bbce05065.js" async></script><script src="/framework-b0d0d270dbf692bac4b7.js" async></script><script src="/app-74d18815dd077486fe4c.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>